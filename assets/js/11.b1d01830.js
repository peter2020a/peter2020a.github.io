(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{281:function(e,n,a){"use strict";a.r(n);var t=a(13),s=Object(t.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"docker安装nacos"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker安装nacos"}},[e._v("#")]),e._v(" Docker安装Nacos")]),e._v(" "),n("h2",{attrs:{id:"_1-拉取nacos镜像文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-拉取nacos镜像文件"}},[e._v("#")]),e._v(" 1.拉取nacos镜像文件")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("docker pull nacos/nacos-server:2.0.3\n")])])]),n("h2",{attrs:{id:"_2-挂载目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-挂载目录"}},[e._v("#")]),e._v(" 2.挂载目录")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("# 新建logs目录\nmkdir -p /var/nacos_mount/logs/\n# 新建配置文件目录\nmkdir -p /var/nacos_mount/conf/\n")])])]),n("h2",{attrs:{id:"_3-添加配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加配置文件"}},[e._v("#")]),e._v(" 3.添加配置文件")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("vi /var/nacos_mount/conf/application.properties\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('#\n# Copyright 1999-2021 Alibaba Group Holding Ltd.\n#\n# Licensed under the Apache License, Version 2.0 (the "License");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an "AS IS" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\n#*************** Spring Boot Related Configurations ***************#\n### Default web context path:\nserver.servlet.contextPath=/nacos\n### Default web server port:\nserver.port=8848\n\n#*************** Network Related Configurations ***************#\n### If prefer hostname over ip for Nacos server addresses in cluster.conf:\n# nacos.inetutils.prefer-hostname-over-ip=false\n\n### Specify local server\'s IP:\n# nacos.inetutils.ip-address=\n\n\n#*************** Config Module Related Configurations ***************#\n### If use MySQL as datasource:\nspring.datasource.platform=mysql\n\n### Count of DB:\ndb.num=1\n\n### Connect URL of DB:\ndb.url.0=jdbc:mysql://192.168.71.19:3306/nacos_dev?serverTimezone=Asia/Shanghai&characterEncoding=utf8&allowPublicKeyRetrieval=true&useSSL=false\ndb.user=root\ndb.password=budsoft2020\n\n### Connection pool configuration: hikariCP\ndb.pool.config.connectionTimeout=30000\ndb.pool.config.validationTimeout=10000\ndb.pool.config.maximumPoolSize=20\ndb.pool.config.minimumIdle=2\n\n#*************** Naming Module Related Configurations ***************#\n### Data dispatch task execution period in milliseconds: Will removed on v2.1.X, replace with nacos.core.protocol.distro.data.sync.delayMs\n# nacos.naming.distro.taskDispatchPeriod=200\n\n### Data count of batch sync task: Will removed on v2.1.X. Deprecated\n# nacos.naming.distro.batchSyncKeyCount=1000\n\n### Retry delay in milliseconds if sync task failed: Will removed on v2.1.X, replace with nacos.core.protocol.distro.data.sync.retryDelayMs\n# nacos.naming.distro.syncRetryDelay=5000\n\n### If enable data warmup. If set to false, the server would accept request without local data preparation:\n# nacos.naming.data.warmup=true\n\n### If enable the instance auto expiration, kind like of health check of instance:\n# nacos.naming.expireInstance=true\n\n### will be removed and replaced by `nacos.naming.clean` properties\nnacos.naming.empty-service.auto-clean=true\nnacos.naming.empty-service.clean.initial-delay-ms=50000\nnacos.naming.empty-service.clean.period-time-ms=30000\n\n### Add in 2.0.0\n### The interval to clean empty service, unit: milliseconds.\n# nacos.naming.clean.empty-service.interval=60000\n\n### The expired time to clean empty service, unit: milliseconds.\n# nacos.naming.clean.empty-service.expired-time=60000\n\n### The interval to clean expired metadata, unit: milliseconds.\n# nacos.naming.clean.expired-metadata.interval=5000\n\n### The expired time to clean metadata, unit: milliseconds.\n# nacos.naming.clean.expired-metadata.expired-time=60000\n\n### The delay time before push task to execute from service changed, unit: milliseconds.\n# nacos.naming.push.pushTaskDelay=500\n\n### The timeout for push task execute, unit: milliseconds.\n# nacos.naming.push.pushTaskTimeout=5000\n\n### The delay time for retrying failed push task, unit: milliseconds.\n# nacos.naming.push.pushTaskRetryDelay=1000\n\n### Since 2.0.3\n### The expired time for inactive client, unit: milliseconds.\n# nacos.naming.client.expired.time=180000\n\n#*************** CMDB Module Related Configurations ***************#\n### The interval to dump external CMDB in seconds:\n# nacos.cmdb.dumpTaskInterval=3600\n\n### The interval of polling data change event in seconds:\n# nacos.cmdb.eventTaskInterval=10\n\n### The interval of loading labels in seconds:\n# nacos.cmdb.labelTaskInterval=300\n\n### If turn on data loading task:\n# nacos.cmdb.loadDataAtStart=false\n\n\n#*************** Metrics Related Configurations ***************#\n### Metrics for prometheus\n#management.endpoints.web.exposure.include=*\n\n### Metrics for elastic search\nmanagement.metrics.export.elastic.enabled=false\n#management.metrics.export.elastic.host=http://localhost:9200\n\n### Metrics for influx\nmanagement.metrics.export.influx.enabled=false\n#management.metrics.export.influx.db=springboot\n#management.metrics.export.influx.uri=http://localhost:8086\n#management.metrics.export.influx.auto-create-db=true\n#management.metrics.export.influx.consistency=one\n#management.metrics.export.influx.compressed=true\n\n#*************** Access Log Related Configurations ***************#\n### If turn on the access log:\nserver.tomcat.accesslog.enabled=true\n\n### The access log pattern:\nserver.tomcat.accesslog.pattern=%h %l %u %t "%r" %s %b %D %{User-Agent}i %{Request-Source}i\n\n### The directory of access log:\nserver.tomcat.basedir=\n\n#*************** Access Control Related Configurations ***************#\n### If enable spring security, this option is deprecated in 1.2.0:\n#spring.security.enabled=false\n\n### The ignore urls of auth, is deprecated in 1.2.0:\nnacos.security.ignore.urls=/,/error,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.ico,/console-ui/public/**,/v1/auth/**,/v1/console/health/**,/actuator/**,/v1/console/server/**\n\n### The auth system to use, currently only \'nacos\' and \'ldap\' is supported:\nnacos.core.auth.system.type=nacos\n\n### If turn on auth system:\nnacos.core.auth.enabled=false\n\n### worked when nacos.core.auth.system.type=ldap，{0} is Placeholder,replace login username\n# nacos.core.auth.ldap.url=ldap://localhost:389\n# nacos.core.auth.ldap.userdn=cn={0},ou=user,dc=company,dc=com\n\n### The token expiration in seconds:\nnacos.core.auth.default.token.expire.seconds=18000\n\n### The default token:\nnacos.core.auth.default.token.secret.key=SecretKey012345678901234567890123456789012345678901234567890123456789\n\n### Turn on/off caching of auth information. By turning on this switch, the update of auth information would have a 15 seconds delay.\nnacos.core.auth.caching.enabled=true\n\n### Since 1.4.1, Turn on/off white auth for user-agent: nacos-server, only for upgrade from old version.\nnacos.core.auth.enable.userAgentAuthWhite=false\n\n### Since 1.4.1, worked when nacos.core.auth.enabled=true and nacos.core.auth.enable.userAgentAuthWhite=false.\n### The two properties is the white list for auth and used by identity the request from other server.\nnacos.core.auth.server.identity.key=serverIdentity\nnacos.core.auth.server.identity.value=security\n\n#*************** Istio Related Configurations ***************#\n### If turn on the MCP server:\nnacos.istio.mcp.server.enabled=false\n\n#*************** Core Related Configurations ***************#\n\n### set the WorkerID manually\n# nacos.core.snowflake.worker-id=\n\n### Member-MetaData\n# nacos.core.member.meta.site=\n# nacos.core.member.meta.adweight=\n# nacos.core.member.meta.weight=\n\n### MemberLookup\n### Addressing pattern category, If set, the priority is highest\n# nacos.core.member.lookup.type=[file,address-server]\n## Set the cluster list with a configuration file or command-line argument\n# nacos.member.list=192.168.16.101:8847?raft_port=8807,192.168.16.101?raft_port=8808,192.168.16.101:8849?raft_port=8809\n## for AddressServerMemberLookup\n# Maximum number of retries to query the address server upon initialization\n# nacos.core.address-server.retry=5\n## Server domain name address of [address-server] mode\n# address.server.domain=jmenv.tbsite.net\n## Server port of [address-server] mode\n# address.server.port=8080\n## Request address of [address-server] mode\n# address.server.url=/nacos/serverlist\n\n#*************** JRaft Related Configurations ***************#\n\n### Sets the Raft cluster election timeout, default value is 5 second\n# nacos.core.protocol.raft.data.election_timeout_ms=5000\n### Sets the amount of time the Raft snapshot will execute periodically, default is 30 minute\n# nacos.core.protocol.raft.data.snapshot_interval_secs=30\n### raft internal worker threads\n# nacos.core.protocol.raft.data.core_thread_num=8\n### Number of threads required for raft business request processing\n# nacos.core.protocol.raft.data.cli_service_thread_num=4\n### raft linear read strategy. Safe linear reads are used by default, that is, the Leader tenure is confirmed by heartbeat\n# nacos.core.protocol.raft.data.read_index_type=ReadOnlySafe\n### rpc request timeout, default 5 seconds\n# nacos.core.protocol.raft.data.rpc_request_timeout_ms=5000\n\n#*************** Distro Related Configurations ***************#\n\n### Distro data sync delay time, when sync task delayed, task will be merged for same data key. Default 1 second.\n# nacos.core.protocol.distro.data.sync.delayMs=1000\n\n### Distro data sync timeout for one sync data, default 3 seconds.\n# nacos.core.protocol.distro.data.sync.timeoutMs=3000\n\n### Distro data sync retry delay time when sync data failed or timeout, same behavior with delayMs, default 3 seconds.\n# nacos.core.protocol.distro.data.sync.retryDelayMs=3000\n\n### Distro data verify interval time, verify synced data whether expired for a interval. Default 5 seconds.\n# nacos.core.protocol.distro.data.verify.intervalMs=5000\n\n### Distro data verify timeout for one verify, default 3 seconds.\n# nacos.core.protocol.distro.data.verify.timeoutMs=3000\n\n### Distro data load retry delay when load snapshot data failed, default 30 seconds.\n# nacos.core.protocol.distro.data.load.retryDelayMs=30000\n')])])]),n("h2",{attrs:{id:"_4-启动容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-启动容器"}},[e._v("#")]),e._v(" 4.启动容器")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("# 普通启动命令\ndocker run --rm -e MODE=standalone --name nacos -p 8848:8848 -p 9848:9848 -p 9849:9849 -d nacos/nacos-server:2.0.3\n\n# 带配置信息的启动\ndocker  run --name nacos -p 8848:8848 -p 9848:9848 -p 9849:9849 \\\n--privileged=true \\\n--restart=always \\\n-e JVM_XMS=128m \\\n-e JVM_XMX=128m \\\n-e MODE=standalone \\\n-e PREFER_HOST_MODE=hostname \\\n-v /var/nacos_mount/logs:/home/nacos/logs \\\n-v /var/nacos_mount/conf/application.properties:/home/nacos/conf/application.properties \\\n-d nacos/nacos-server:2.0.3\n\n")])])]),n("h2",{attrs:{id:"_5-设置nacos服务自启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-设置nacos服务自启动"}},[e._v("#")]),e._v(" 5.设置nacos服务自启动")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("docker update --restart=always  nacos\n")])])])])}),[],!1,null,null,null);n.default=s.exports}}]);