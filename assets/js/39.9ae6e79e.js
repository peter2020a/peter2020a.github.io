(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{310:function(e,t,s){"use strict";s.r(t);var n=s(13),a=Object(n.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"openresty-使用介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#openresty-使用介绍"}},[e._v("#")]),e._v(" OpenResty 使用介绍")]),e._v(" "),t("h2",{attrs:{id:"openresty-介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#openresty-介绍"}},[e._v("#")]),e._v(" OpenResty 介绍")]),e._v(" "),t("p",[e._v("OpenResty(又称：ngx_openresty) 是一个基于 NGINX 的可伸缩的 Web 平台，由中国人章亦春发起，提供了很多高质量的第三方模块。")]),e._v(" "),t("p",[e._v("OpenResty 是一个强大的 Web 应用服务器，Web 开发人员可以使用 Lua 脚本语言调动 Nginx 支持的各种 C 以及 Lua 模块,更主要的是在性能方面，OpenResty可以 快速构造出足以胜任 10K 以上并发连接响应的超高性能 Web 应用系统。")]),e._v(" "),t("p",[e._v("360，UPYUN，阿里云，新浪，腾讯网，去哪儿网，酷狗音乐等都是 OpenResty 的深度用户。")]),e._v(" "),t("h2",{attrs:{id:"openresty-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#openresty-安装"}},[e._v("#")]),e._v(" OpenResty 安装")]),e._v(" "),t("p",[e._v("OpenResty 依赖库有： perl 5.6.1+, libreadline, libpcre, libssl。")]),e._v(" "),t("p",[e._v("所以我们需要先安装好这些依赖库，也非常简单。如果你的系统是 Centos 或 RedHat 可以使用以下命令：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("yum install readline-devel pcre-devel openssl-devel\n")])])]),t("p",[e._v("接下我们可以在官方（https://openresty.org/cn/）下载最新的 OpenResty 源码包并解压编译安装:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("wget https://openresty.org/download/ngx_openresty-1.9.7.1.tar.gz   # 下载\ntar xzvf ngx_openresty-1.9.7.1.tar.gz       # 解压\ncd ngx_openresty-1.9.7.1/ \n./configure\nmake \nmake install\n")])])]),t("p",[e._v("默认情况下程序会被安装到 /usr/local/openresty 目录，你可以使用 ./configure --help 查看更多的配置选项。")]),e._v(" "),t("h2",{attrs:{id:"hello-world-实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hello-world-实例"}},[e._v("#")]),e._v(" Hello World 实例")]),e._v(" "),t("p",[e._v("安装成功后，我们就可以使用 openresty 直接输出 html 页面。")]),e._v(" "),t("p",[e._v("首先我们可以创建一个工作目录：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("mkdir /home/www\ncd /home/www/\nmkdir logs/ conf/\n")])])]),t("p",[e._v("中 logs 目录用于存放日志，conf 用于存放配置文件。")]),e._v(" "),t("p",[e._v("接着，我们在 conf 目录下创建一个 nginx.conf 文件 代码如下：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("worker_processes  1;\nerror_log logs/error.log;\nevents {\n    worker_connections 1024;\n}\nhttp {\n    server {\n        listen 9000;\n        location / {\n            default_type text/html;\n            content_by_lua '\n                ngx.say(\"<p>Hello, World!</p>\")\n            ';\n        }\n    }\n}\n")])])]),t("p",[e._v("如果你熟悉 nginx 的配置，应该对以上代码就很熟悉。这里我们将 html 代码直接写在了配置文件中。")]),e._v(" "),t("h2",{attrs:{id:"启动-openresty"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动-openresty"}},[e._v("#")]),e._v(" 启动 openresty")]),e._v(" "),t("p",[e._v("默认情况下 openresty 安装在 /usr/local/openresty 目录中，启动命令为:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("cd /home/www\n/usr/local/openresty/nginx/sbin/nginx -p `pwd`/ -c conf/nginx.conf\n")])])]),t("p",[e._v("如果没有任何输出，说明启动成功，-p 指定我们的项目目录，-c 指定配置文件。")]),e._v(" "),t("p",[e._v("热更新Nginx配置可以用如下命令：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("cd /home/www\n/usr/local/openresty/nginx/sbin/nginx -p `pwd`/ -s reload\n")])])]),t("p",[e._v("接下来我们可以使用 curl 来测试是否能够正常范围：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("curl http://localhost:9000/\n")])])]),t("p",[e._v("输出结果为：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("<p>Hello, World!</p>\n")])])]),t("p",[e._v("或者通过浏览器访问 http://localhost:9000/：")]),e._v(" "),t("p",[e._v("看到了吧，我们在配置文件写的 html 已正常输出。")]),e._v(" "),t("p",[e._v("OpenResty 的目标是让你的 Web 服务直接跑在 Nginx 服务内部,充分利用 Nginx 的非阻塞 I/O 模型,不仅仅对 HTTP 客户端请求,甚至于对远程后端诸如 MySQL,PostgreSQL,~Memcaches 以及 ~Redis 等都进行一致的高性能响应。")]),e._v(" "),t("p",[e._v("所以对于一些高性能的服务来说，可以直接使用 OpenResty 访问 Mysql或Redis等，而不需要通过第三方语言（PHP、Python、Ruby）等来访问数据库再返回，这大大提高了应用的性能。")])])}),[],!1,null,null,null);t.default=a.exports}}]);